# 区域选择器与长势图表联动功能说明

## 📋 功能概览

区域选择器与长势图表联动功能实现了当用户选择不同区域时，图表自动切换显示对应的数据内容。支持全县汇总数据和单个乡镇的长势分类数据两种显示模式。

## 🎯 核心功能

### 1. 区域选择联动
- **全县模式**: 选择"全县"时显示所有乡镇的面积汇总柱状图
- **单乡镇模式**: 选择具体乡镇时显示该乡镇的长势分类数据（优、良、中、差）

### 2. 图表类型切换
- **柱状图**: 直观显示数据对比
- **表格**: 详细显示具体数值

### 3. 实时数据更新
- 选择区域时图表标题自动更新
- 图表数据实时切换
- 表格内容动态调整

## 🎮 使用方法

### 1. 查看全县数据
1. 点击顶部区域选择器
2. 选择"全县"
3. 图表显示所有乡镇的面积分布

### 2. 查看单个乡镇长势
1. 点击顶部区域选择器
2. 选择任意乡镇（如"城关镇"）
3. 图表自动切换为该乡镇的长势分类数据
4. 标题更新为"🌾 城关镇长势分类分布"

### 3. 切换显示方式
- 点击"柱状图"按钮：以柱状图形式显示
- 点击"表格"按钮：以表格形式显示详细数值

## 📊 数据说明

### 全县模式数据
显示各乡镇的总面积分布：
- 红台镇: 456亩
- 土桥镇: 398亩
- 漫路镇: 268亩
- 北塬镇: 134亩
- 关滩镇: 312亩
- 新集镇: 289亩
- 麻尼寺沟镇: 198亩
- 韩集镇: 167亩

### 单乡镇模式数据
显示选中乡镇的长势分类：

| 乡镇 | 优(亩) | 良(亩) | 中(亩) | 差(亩) |
|------|--------|--------|--------|--------|
| 城关镇 | 180 | 135 | 90 | 45 |
| 土场镇 | 160 | 120 | 80 | 40 |
| 北塔镇 | 110 | 82 | 55 | 28 |
| 红光镇 | 140 | 105 | 70 | 35 |
| 积石山镇 | 200 | 150 | 100 | 50 |
| 韩家集镇 | 130 | 98 | 65 | 33 |
| 新集镇 | 120 | 90 | 60 | 30 |
| 刘家峡镇 | 95 | 71 | 47 | 24 |
| 太平镇 | 115 | 86 | 58 | 29 |
| 民丰镇 | 105 | 79 | 52 | 26 |

## 🎨 视觉设计

### 长势分类颜色方案
- **优**: #00FF88 (绿色) - 表示长势优秀
- **良**: #00D4FF (蓝色) - 表示长势良好
- **中**: #FFD700 (金色) - 表示长势中等
- **差**: #FF4500 (橙红色) - 表示长势较差

### 图表样式特点
- 透明背景适配大屏主题
- 白色文字确保可读性
- 科技感配色方案
- 响应式布局设计

## 🔧 技术实现

### 核心函数

#### 1. 图表切换函数
```javascript
function switchTownCropChart(chartType) {
    // 更新按钮状态
    // 切换显示内容
    // 更新图表数据
}
```

#### 2. 图表更新函数
```javascript
function updateTownCropChart(regionId, chartType) {
    // 获取ECharts实例
    // 根据区域ID生成配置
    // 更新图表显示
}
```

#### 3. 表格更新函数
```javascript
function updateTownCropTable(regionId) {
    // 更新表格标题
    // 更新表格内容
    // 计算合计数据
}
```

#### 4. 区域联动函数
```javascript
function selectRegion(regionId, regionName) {
    // 更新区域选择器状态
    // 联动乡镇地块显示
    // 更新图表和表格
}
```

### 数据获取函数

#### 1. 单乡镇长势数据
```javascript
function getSingleTownshipGrowthData(regionId) {
    // 返回指定乡镇的长势分类数据
    // { excellent, good, medium, poor }
}
```

#### 2. 乡镇名称映射
```javascript
function getTownshipNameById(regionId) {
    // 根据区域ID返回中文名称
}
```

## 🚀 扩展功能

### 已实现功能
- ✅ 区域选择器联动
- ✅ 图表类型切换
- ✅ 实时数据更新
- ✅ 标题动态更新
- ✅ 表格数据联动
- ✅ 颜色分类显示

### 可扩展功能
- 🔄 饼状图显示模式
- 🔄 数据导出功能
- 🔄 历史数据对比
- 🔄 动画过渡效果
- 🔄 数据钻取功能
- 🔄 实时数据接口

## 📱 兼容性

### 浏览器支持
- ✅ Chrome 80+
- ✅ Firefox 75+
- ✅ Safari 13+
- ✅ Edge 80+

### 分辨率支持
- ✅ 1920×1080 (推荐)
- ✅ 1366×768
- ✅ 1024×768

## 🐛 故障排除

### 常见问题

**问题**: 选择区域后图表不更新
**解决**: 检查控制台是否有JavaScript错误，确保ECharts库正确加载

**问题**: 表格数据显示不正确
**解决**: 检查数据获取函数是否正确返回数据

**问题**: 按钮状态不更新
**解决**: 检查CSS类名是否正确应用

### 调试方法
```javascript
// 检查当前选择的区域
console.log('当前区域:', currentSelectedRegion);

// 检查图表类型
console.log('图表类型:', currentChartType);

// 检查数据获取
console.log('长势数据:', getSingleTownshipGrowthData('chengguan'));
```

## 📝 更新日志

### v1.0.0 (2024-01-15)
- ✅ 初始版本发布
- ✅ 区域选择器联动功能
- ✅ 图表类型切换功能
- ✅ 长势分类数据显示
- ✅ 表格数据联动

---

**开发团队**: 农情遥感系统开发组  
**最后更新**: 2024-01-15  
**版本**: v1.0.0
