<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å†œæƒ…é¥æ„Ÿç³»ç»Ÿå¤§å± - æ°”è±¡ç›‘æµ‹åŠŸèƒ½</title>
    
    <!-- å¼•å…¥Cesium CSS -->
    <script src="https://cesium.com/downloads/cesiumjs/releases/1.110/Build/Cesium/Cesium.js"></script>
    <link href="https://cesium.com/downloads/cesiumjs/releases/1.110/Build/Cesium/Widgets/widgets.css" rel="stylesheet">

    
    <!-- å¼•å…¥ECharts -->
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    
    <!-- å¼•å…¥æ ·å¼æ–‡ä»¶ -->
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/cesium-map.css">
    <link rel="stylesheet" href="assets/css/weather-monitoring.css">
    <link rel="stylesheet" href="assets/css/township-blocks.css">
    <link rel="stylesheet" href="assets/css/timeline.css">
</head>
<body>
    <!-- é¡¶éƒ¨ç³»ç»Ÿæ¨ªå¹… -->
    <div class="system-header">
        <!-- å·¦ä¾§ç³»ç»ŸçŠ¶æ€ -->
        <div class="header-left">
            <div class="system-status">
                <span class="status-dot"></span>
                <span class="status-text">ç³»ç»Ÿè¿è¡Œæ­£å¸¸</span>
            </div>
        </div>

        <!-- ä¸­å¿ƒæ ‡é¢˜ -->
        <div class="system-title">
            ä¸´å¤å¿å«æ˜Ÿé¥æ„Ÿå¹³å°
            <div class="system-subtitle">Linxia County Satellite Remote Sensing Platform</div>
        </div>

        <!-- å³ä¾§æ—¶é—´æ˜¾ç¤ºå’Œç”¨æˆ·ä¿¡æ¯ -->
        <div class="header-right">
            <div class="current-time">
                <div class="time-display" id="current-time">2024-01-15 14:30:25</div>
                <div class="date-display" id="current-date">æ˜ŸæœŸä¸€</div>
            </div>

            <!-- åŒºåŸŸé€‰æ‹© -->
            <div class="region-selector">
                <div class="region-display" onclick="toggleRegionDropdown()">
                    <span class="region-icon">ğŸ“</span>
                    <span class="region-name" id="selected-region">å…¨å¿</span>
                    <span class="dropdown-arrow">â–¼</span>
                </div>

                <!-- åŒºåŸŸä¸‹æ‹‰èœå• -->
                <div class="region-dropdown" id="region-dropdown">
                    <div class="dropdown-item active" data-region="all" onclick="selectRegion('all', 'å…¨å¿')">
                        <span>ğŸ›ï¸</span>
                        <span>å…¨å¿</span>
                    </div>
                    <div class="dropdown-divider"></div>
                    <div class="dropdown-item" data-region="chengguan" onclick="selectRegion('chengguan', 'åŸå…³é•‡')">
                        <span>ğŸ¢</span>
                        <span>åŸå…³é•‡</span>
                    </div>
                    <div class="dropdown-item" data-region="tuchang" onclick="selectRegion('tuchang', 'åœŸåœºé•‡')">
                        <span>ğŸ˜ï¸</span>
                        <span>åœŸåœºé•‡</span>
                    </div>
                    <div class="dropdown-item" data-region="beita" onclick="selectRegion('beita', 'åŒ—å¡”é•‡')">
                        <span>ğŸ˜ï¸</span>
                        <span>åŒ—å¡”é•‡</span>
                    </div>
                    <div class="dropdown-item" data-region="hongguang" onclick="selectRegion('hongguang', 'çº¢å…‰é•‡')">
                        <span>ğŸ˜ï¸</span>
                        <span>çº¢å…‰é•‡</span>
                    </div>
                    <div class="dropdown-item" data-region="jishishan" onclick="selectRegion('jishishan', 'ç§¯çŸ³å±±é•‡')">
                        <span>ğŸ˜ï¸</span>
                        <span>ç§¯çŸ³å±±é•‡</span>
                    </div>
                    <div class="dropdown-item" data-region="hanjiaji" onclick="selectRegion('hanjiaji', 'éŸ©å®¶é›†é•‡')">
                        <span>ğŸ˜ï¸</span>
                        <span>éŸ©å®¶é›†é•‡</span>
                    </div>
                    <div class="dropdown-item" data-region="xinji" onclick="selectRegion('xinji', 'æ–°é›†é•‡')">
                        <span>ğŸ˜ï¸</span>
                        <span>æ–°é›†é•‡</span>
                    </div>
                    <div class="dropdown-item" data-region="liujiaxia" onclick="selectRegion('liujiaxia', 'åˆ˜å®¶å³¡é•‡')">
                        <span>ğŸ˜ï¸</span>
                        <span>åˆ˜å®¶å³¡é•‡</span>
                    </div>
                    <div class="dropdown-item" data-region="taiping" onclick="selectRegion('taiping', 'å¤ªå¹³é•‡')">
                        <span>ğŸ˜ï¸</span>
                        <span>å¤ªå¹³é•‡</span>
                    </div>
                    <div class="dropdown-item" data-region="minfeng" onclick="selectRegion('minfeng', 'æ°‘ä¸°é•‡')">
                        <span>ğŸ˜ï¸</span>
                        <span>æ°‘ä¸°é•‡</span>
                    </div>
                </div>
            </div>

            <!-- ç”¨æˆ·ä¿¡æ¯åŒºåŸŸ -->
            <div class="user-info">
                <div class="user-avatar">
                    å¼ 
                    <div class="user-status"></div>
                </div>
                <div class="user-details">
                    <div class="user-name">å¼ ä¸‰</div>
                    <div class="user-role">ç³»ç»Ÿç®¡ç†å‘˜</div>
                </div>
                
                <!-- ç”¨æˆ·ä¸‹æ‹‰èœå• -->
                <div class="user-dropdown">
                    <div class="dropdown-item" onclick="showUserProfile()">
                        <span>ğŸ‘¤</span>
                        <span>ä¸ªäººä¿¡æ¯</span>
                    </div>
                    <div class="dropdown-item" onclick="showSystemSettings()">
                        <span>âš™ï¸</span>
                        <span>ç³»ç»Ÿè®¾ç½®</span>
                    </div>
                    <div class="dropdown-item" onclick="showOperationLog()">
                        <span>ğŸ“Š</span>
                        <span>æ“ä½œæ—¥å¿—</span>
                    </div>
                    <div class="dropdown-item" onclick="showHelp()">
                        <span>â“</span>
                        <span>å¸®åŠ©ä¸­å¿ƒ</span>
                    </div>
                    <div class="dropdown-item" onclick="logout()">
                        <span>ğŸšª</span>
                        <span>é€€å‡ºç™»å½•</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- åŠŸèƒ½åˆ‡æ¢æ¨¡å— -->
    <div class="function-switch-bar">
        <!-- ä¸»åŠŸèƒ½æŒ‰é’®ç»„ (5ä¸ª) -->
        <div class="main-switch-buttons">
            <div class="main-switch-btn" data-function="crop-distribution" onclick="navigateToPage('index.html')">
                <span class="btn-icon">ğŸŒ¾</span>
                <span class="btn-text">ä½œç‰©åˆ†å¸ƒ</span>
            </div>
            <div class="main-switch-btn" data-function="growth-analysis" onclick="navigateToPage('growth-analysis-main.html')">
                <span class="btn-icon">ğŸ“Š</span>
                <span class="btn-text">é•¿åŠ¿åˆ†æ</span>
            </div>
            <div class="main-switch-btn" data-function="yield-estimation" onclick="navigateToPage('yield-estimation.html')">
                <span class="btn-icon">ğŸ“ˆ</span>
                <span class="btn-text">äº§é‡é¢„ä¼°</span>
            </div>
            <div class="main-switch-btn active" data-function="weather-monitoring">
                <span class="btn-icon">ğŸŒ¤ï¸</span>
                <span class="btn-text">æ°”è±¡ç›‘æµ‹</span>
            </div>
            <div class="main-switch-btn" data-function="disaster-monitoring" onclick="navigateToPage('disaster-monitoring.html')">
                <span class="btn-icon">âš ï¸</span>
                <span class="btn-text">ç¾å®³å®šæŸ</span>
            </div>
        </div>

        <!-- åˆ†éš”çº¿ -->
        <div class="switch-divider"></div>

        <!-- å åŠ åŠŸèƒ½æŒ‰é’® (2ä¸ª) -->
        <div class="overlay-switch-btn" data-function="device-monitoring">
            <span class="btn-icon">ğŸ“±</span>
            <span class="btn-text">è®¾å¤‡ç›‘æ§</span>
        </div>
        
        <div class="overlay-switch-btn" data-function="crop-selection">
            <span class="btn-icon">ğŸŒ¾</span>
            <span class="btn-text">ä½œç‰©é€‰æ‹©</span>
        </div>

        <!-- ç¬¬äºŒä¸ªåˆ†éš”çº¿ -->
        <div class="switch-divider"></div>

        <!-- åœ°å›¾æ§åˆ¶æŒ‰é’® -->
        <div class="map-reset-btn" title="é‡ç½®è§†å›¾" onclick="resetMapView()">
            <span class="btn-icon">ğŸ¯</span>
            <span class="btn-text">é‡ç½®è§†å›¾</span>
        </div>
    </div>

    <!-- ä¸»åœ°å›¾å®¹å™¨ -->
    <div id="map-container">
        <!-- ç§‘æŠ€æ„ŸèƒŒæ™¯å…ƒç´  -->
        <div class="tech-grid"></div>
        
        <!-- Cesiumåœ°å›¾å®¹å™¨ -->
        <div id="cesium-container"></div>
        
        <!-- æ°”è±¡æ•°æ®å¼¹çª— -->
        <div id="weather-tooltip" class="weather-tooltip" style="display: none;">
            <div class="tooltip-header">
                <span class="tooltip-title" id="tooltip-layer-type">è¯·é€‰æ‹©å›¾å±‚</span>
                <span class="tooltip-coords" id="tooltip-coords"></span>
            </div>
            <div class="tooltip-content">
                <div class="data-item">
                    <span class="data-label">æ•°å€¼:</span>
                    <span class="data-value" id="tooltip-data-value">--</span>
                </div>
                <div class="data-item">
                    <span class="data-label">æ›´æ–°æ—¶é—´:</span>
                    <span class="data-value" id="tooltip-time">--</span>
                </div>
            </div>
        </div>
        
        <!-- åœ°å›¾è¦†ç›–å±‚ -->
        <div class="map-overlay"></div>

        <!-- å³ä¾§æ°”è±¡ç›‘æµ‹æ•°æ®çœ‹æ¿ -->
        <div class="glass-panel right-panel">
            <div class="panel-header">
                <div class="panel-title">
                    ğŸŒ¤ï¸ æ°”è±¡ç›‘æµ‹
                </div>
                <button class="collapse-btn">â–¶</button>
            </div>

            <!-- æ°”è±¡æ•°æ®æ§åˆ¶é¢æ¿ -->
            <div class="stat-card" style="height: auto; max-height: 320px;">
                <div class="stat-header" style="display: flex; justify-content: space-between; align-items: center; height: 28px; line-height: 28px;">
                    <span style="font-size: 15px;">ğŸ—ºï¸ æ°”è±¡æ•°æ®æ§åˆ¶</span>
                    <span style="display: flex; align-items: center; gap: 5px; font-size: 10px;">
                        é€æ˜åº¦
                        <input type="range" id="layer-opacity-slider" min="0" max="100" value="90" style="width: 40px; height: 8px; margin: 0; padding: 0; border: none; outline: none;">
                        <span id="opacity-value">90%</span>
                    </span>
                </div>

                <!-- å›¾å±‚é€‰æ‹© - å•è¡Œå¸ƒå±€ -->
                <div class="weather-layer-tabs" style="display: grid; grid-template-columns: repeat(6, 1fr); gap: 3px; margin-bottom: 10px;">
                    <div class="weather-tab compact" data-layer="precipitation" style="padding: 5px 2px; min-height: 36px;">
                        <div class="tab-icon" style="font-size: 12px;">ğŸŒ§ï¸</div>
                        <div class="tab-name" style="font-size: 9px;">é™é›¨</div>
                    </div>
                    <div class="weather-tab compact" data-layer="temperature" style="padding: 5px 2px; min-height: 36px;">
                        <div class="tab-icon" style="font-size: 12px;">ğŸŒ¡ï¸</div>
                        <div class="tab-name" style="font-size: 9px;">æ°”æ¸©</div>
                    </div>
                    <div class="weather-tab compact" data-layer="humidity" style="padding: 5px 2px; min-height: 36px;">
                        <div class="tab-icon" style="font-size: 12px;">ğŸ’§</div>
                        <div class="tab-name" style="font-size: 9px;">æ¹¿åº¦</div>
                    </div>
                    <div class="weather-tab compact" data-layer="soil-temperature" style="padding: 5px 2px; min-height: 36px;">
                        <div class="tab-icon" style="font-size: 12px;">ğŸŒ¡ï¸</div>
                        <div class="tab-name" style="font-size: 9px;">åœ°æ¸©</div>
                    </div>
                    <div class="weather-tab compact" data-layer="accumulated-temperature" style="padding: 5px 2px; min-height: 36px;">
                        <div class="tab-icon" style="font-size: 12px;">ğŸ”¥</div>
                        <div class="tab-name" style="font-size: 9px;">ç§¯æ¸©</div>
                    </div>
                    <div class="weather-tab compact" data-layer="accumulated-precipitation" style="padding: 5px 2px; min-height: 36px;">
                        <div class="tab-icon" style="font-size: 12px;">ğŸŒŠ</div>
                        <div class="tab-name" style="font-size: 9px;">ç§¯é›¨</div>
                    </div>
                </div>

                <!-- æ—¶é—´æ§åˆ¶ - é€‚ä¸­å¸ƒå±€ -->
                <div class="time-controls-compact">
                    <div class="time-row" style="display: flex; gap: 8px; margin-bottom: 8px; align-items: center;">
                        <label style="font-size: 11px; color: rgba(255,255,255,0.8); min-width: 40px;">æ—¶é—´:</label>
                        <input type="date" id="selected-date" value="" style="height: 26px; font-size: 11px; flex: 1;">
                        <input type="time" id="selected-time" value="" style="height: 26px; font-size: 11px; flex: 1;">
                    </div>

                    <div class="time-slider-row" style="margin-bottom: 8px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 3px;">
                            <span style="font-size: 10px; color: rgba(255,255,255,0.6);">7å¤©å‰</span>
                            <span style="font-size: 10px; color: rgba(255,255,255,0.8);">æ—¶é—´è½´</span>
                            <span style="font-size: 10px; color: rgba(255,255,255,0.6);">ç°åœ¨</span>
                        </div>
                        <input type="range" id="time-slider" min="-168" max="0" value="0" step="1" style="width: 100%; height: 18px;">
                    </div>

                    <div class="animation-controls-compact" style="display: flex; gap: 4px;">
                        <button class="control-btn compact" id="play-btn" style="flex: 1; height: 24px; font-size: 10px; padding: 2px 4px;">â–¶ï¸</button>
                        <button class="control-btn compact" id="pause-btn" style="flex: 1; height: 24px; font-size: 10px; padding: 2px 4px;">â¸ï¸</button>
                        <button class="control-btn compact" id="reset-btn" style="flex: 1; height: 24px; font-size: 10px; padding: 2px 4px;">ğŸ”„</button>
                        <button class="control-btn compact" id="speed-btn" style="flex: 1; height: 24px; font-size: 10px; padding: 2px 4px;">1x</button>
                    </div>
                </div>
            </div>

            <!-- å½“å‰å¤©æ°”çŠ¶å†µå¡ç‰‡ -->
            <div class="stat-card">
                <div class="stat-header">
                    ğŸŒˆ å½“å‰å¤©æ°”çŠ¶å†µ
                </div>
                <div class="current-weather">
                    <div class="weather-main">
                        <div class="weather-icon">â˜ï¸</div>
                        <div class="weather-info">
                            <div class="weather-desc">å¤šäº‘</div>
                            <div class="weather-temp">18.00Â°C</div>
                        </div>
                    </div>
                    
                    <div class="weather-details">
                        <div class="detail-item">
                            <span class="detail-label">ä½“æ„Ÿæ¸©åº¦</span>
                            <span class="detail-value">20.00Â°C</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">ç›¸å¯¹æ¹¿åº¦</span>
                            <span class="detail-value">65.00%</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">é£é€Ÿ</span>
                            <span class="detail-value">3.20 m/s</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">é£å‘</span>
                            <span class="detail-value">ä¸œå—é£</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">æ°”å‹</span>
                            <span class="detail-value">1013.00 hPa</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">èƒ½è§åº¦</span>
                            <span class="detail-value">15.00 km</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ä¸ƒå¤©æ°”è±¡æ•°æ®å¯è§†åŒ–é¢æ¿ -->
            <div class="stat-card">
                <div class="stat-header">
                    ğŸ“Š ä¸ƒå¤©æ°”è±¡æ•°æ®åˆ†æ
                    <span style="font-size: 9px; color: rgba(255,255,255,0.6); margin-left: 8px;">é¢„æµ‹/å†å²æ•°æ®</span>
                </div>

                <!-- æ•°æ®ç±»å‹é€‰æ‹©å™¨ -->
                <div class="weather-data-selector" style="margin-bottom: 12px;">
                    <div class="data-type-tabs" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 3px; margin-bottom: 8px;">
                        <div class="data-tab active" data-type="weather" style="padding: 4px 2px; min-height: 28px; text-align: center; cursor: pointer; border-radius: 4px; background: rgba(0, 212, 255, 0.2); border: 1px solid rgba(0, 212, 255, 0.5);">
                            <div style="font-size: 10px; color: #00D4FF;">ğŸŒ¤ï¸</div>
                            <div style="font-size: 8px;">å¤©æ°”é¢„æµ‹</div>
                        </div>
                        <div class="data-tab" data-type="precipitation" style="padding: 4px 2px; min-height: 28px; text-align: center; cursor: pointer; border-radius: 4px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1);">
                            <div style="font-size: 10px;">ğŸŒ§ï¸</div>
                            <div style="font-size: 8px;">é™é›¨æ•°æ®</div>
                        </div>
                        <div class="data-tab" data-type="temperature" style="padding: 4px 2px; min-height: 28px; text-align: center; cursor: pointer; border-radius: 4px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1);">
                            <div style="font-size: 10px;">ğŸŒ¡ï¸</div>
                            <div style="font-size: 8px;">æ°”æ¸©æ•°æ®</div>
                        </div>
                        <div class="data-tab" data-type="soil-temp" style="padding: 4px 2px; min-height: 28px; text-align: center; cursor: pointer; border-radius: 4px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1);">
                            <div style="font-size: 10px;">ğŸŒ¡ï¸</div>
                            <div style="font-size: 8px;">åœ°æ¸©æ•°æ®</div>
                        </div>
                    </div>
                    <div class="data-type-tabs-row2" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 3px;">
                        <div class="data-tab" data-type="accumulated-temp" style="padding: 4px 2px; min-height: 28px; text-align: center; cursor: pointer; border-radius: 4px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1);">
                            <div style="font-size: 10px;">ğŸ”¥</div>
                            <div style="font-size: 8px;">ç§¯æ¸©</div>
                        </div>
                        <div class="data-tab" data-type="accumulated-rain" style="padding: 4px 2px; min-height: 28px; text-align: center; cursor: pointer; border-radius: 4px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1);">
                            <div style="font-size: 10px;">ğŸŒŠ</div>
                            <div style="font-size: 8px;">ç§¯é›¨</div>
                        </div>
                        <div class="data-tab" data-type="humidity" style="padding: 4px 2px; min-height: 28px; text-align: center; cursor: pointer; border-radius: 4px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1);">
                            <div style="font-size: 10px;">ğŸ’§</div>
                            <div style="font-size: 8px;">ç›¸å¯¹æ¹¿åº¦</div>
                        </div>
                    </div>
                </div>

                <!-- æ•°æ®å¯è§†åŒ–å›¾è¡¨åŒºåŸŸ -->
                <div class="weather-chart-container" style="height: 180px; position: relative;">
                    <!-- ä¸ƒå¤©å¤©æ°”é¢„æµ‹ -->
                    <div id="weather-forecast-chart" class="chart-panel active" style="height: 100%; display: block;">
                        <div id="seven-day-weather-chart" style="height: 100%;"></div>
                    </div>

                    <!-- é™é›¨æ•°æ®å›¾è¡¨ -->
                    <div id="precipitation-chart" class="chart-panel" style="height: 100%; display: none;">
                        <div id="seven-day-precipitation-chart" style="height: 100%;"></div>
                    </div>

                    <!-- æ°”æ¸©æ•°æ®å›¾è¡¨ -->
                    <div id="temperature-chart" class="chart-panel" style="height: 100%; display: none;">
                        <div id="seven-day-temperature-chart" style="height: 100%;"></div>
                    </div>

                    <!-- åœ°æ¸©æ•°æ®å›¾è¡¨ -->
                    <div id="soil-temp-chart" class="chart-panel" style="height: 100%; display: none;">
                        <div id="seven-day-soil-temp-chart" style="height: 100%;"></div>
                    </div>

                    <!-- ç§¯æ¸©æ•°æ®å›¾è¡¨ -->
                    <div id="accumulated-temp-chart" class="chart-panel" style="height: 100%; display: none;">
                        <div id="seven-day-accumulated-temp-chart" style="height: 100%;"></div>
                    </div>

                    <!-- ç§¯é›¨æ•°æ®å›¾è¡¨ -->
                    <div id="accumulated-rain-chart" class="chart-panel" style="height: 100%; display: none;">
                        <div id="seven-day-accumulated-rain-chart" style="height: 100%;"></div>
                    </div>

                    <!-- ç›¸å¯¹æ¹¿åº¦æ•°æ®å›¾è¡¨ -->
                    <div id="humidity-chart" class="chart-panel" style="height: 100%; display: none;">
                        <div id="seven-day-humidity-chart" style="height: 100%;"></div>
                    </div>
                </div>

                <!-- æ•°æ®ç»Ÿè®¡ä¿¡æ¯ -->
                <div class="data-statistics" style="margin-top: 8px; padding: 6px; background: rgba(255, 255, 255, 0.03); border-radius: 4px;">
                    <div class="stats-row" style="display: flex; justify-content: space-between; font-size: 9px;">
                        <span id="stat-avg" style="color: rgba(255, 255, 255, 0.7);">å¹³å‡å€¼: --</span>
                        <span id="stat-max" style="color: #FF6B6B;">æœ€é«˜: --</span>
                        <span id="stat-min" style="color: #4ECDC4;">æœ€ä½: --</span>
                        <span id="stat-trend" style="color: #00D4FF;">è¶‹åŠ¿: --</span>
                    </div>
                </div>
            </div>

            <div class="update-time">
                ğŸ”„ æ•°æ®æ›´æ–°: 2024-01-15 14:30 | æ°”è±¡æ•°æ®: ä¸­å¤®æ°”è±¡å°
            </div>
        </div>
    </div>

    <!-- æ—¶é—´è½´ç»„ä»¶ -->
    <div class="timeline-container" id="timeline-container">
        <!-- æ—¶é—´è½´æ ‡é¢˜æ  -->
        <div class="timeline-header">
            <div class="timeline-title">
                <span class="timeline-icon">ğŸ“…</span>
                <span class="timeline-text">æ•°æ®æ—¶é—´è½´</span>
            </div>
            <div class="timeline-controls">
                <span class="timeline-year">2025å¹´</span>
            </div>
        </div>
        
        <!-- æ—¶é—´è½´ä¸»ä½“ -->
        <div class="timeline-track">
            <!-- æ—¶é—´è½´èƒŒæ™¯çº¿ -->
            <div class="timeline-line"></div>
            
            <!-- è¿›åº¦æŒ‡ç¤ºæ¡ -->
            <div class="timeline-progress" id="timeline-progress" style="width: 66.67%;"></div>
            
            <!-- å½“å‰æ—¶é—´æŒ‡ç¤ºå™¨ -->
            <div class="current-time-indicator" id="current-time-indicator" style="left: 62.5%;">
                <div class="indicator-dot"></div>
                <div class="indicator-label">å½“å‰</div>
            </div>
            
            <!-- æœˆä»½èŠ‚ç‚¹å®¹å™¨ -->
            <div class="timeline-months" id="timeline-months">
                <!-- 1æœˆ -->
                <div class="month-node winter" data-month="1" data-season="winter" onclick="selectMonth(1)" title="1æœˆæ•°æ® - å†¬å­£ä½œç‰©ä¼‘çœ æœŸ">
                    <div class="month-dot"></div>
                    <div class="month-label">1æœˆ</div>
                    <div class="season-indicator">å†¬</div>
                </div>
                
                <!-- 2æœˆ -->
                <div class="month-node winter" data-month="2" data-season="winter" onclick="selectMonth(2)" title="2æœˆæ•°æ® - æ˜¥è€•å‡†å¤‡æœŸ">
                    <div class="month-dot"></div>
                    <div class="month-label">2æœˆ</div>
                    <div class="season-indicator">å†¬</div>
                </div>
                
                <!-- 3æœˆ -->
                <div class="month-node spring" data-month="3" data-season="spring" onclick="selectMonth(3)" title="3æœˆæ•°æ® - æ˜¥è€•æ’­ç§æœŸ">
                    <div class="month-dot"></div>
                    <div class="month-label">3æœˆ</div>
                    <div class="season-indicator">æ˜¥</div>
                </div>
                
                <!-- 4æœˆ -->
                <div class="month-node spring" data-month="4" data-season="spring" onclick="selectMonth(4)" title="4æœˆæ•°æ® - ä½œç‰©ç”Ÿé•¿æœŸ">
                    <div class="month-dot"></div>
                    <div class="month-label">4æœˆ</div>
                    <div class="season-indicator">æ˜¥</div>
                </div>
                
                <!-- 5æœˆ -->
                <div class="month-node spring" data-month="5" data-season="spring" onclick="selectMonth(5)" title="5æœˆæ•°æ® - ä½œç‰©å¿«é€Ÿç”Ÿé•¿æœŸ">
                    <div class="month-dot"></div>
                    <div class="month-label">5æœˆ</div>
                    <div class="season-indicator">æ˜¥</div>
                </div>
                
                <!-- 6æœˆ -->
                <div class="month-node summer" data-month="6" data-season="summer" onclick="selectMonth(6)" title="6æœˆæ•°æ® - å¤å­£ç”Ÿé•¿æ—ºæœŸ">
                    <div class="month-dot"></div>
                    <div class="month-label">6æœˆ</div>
                    <div class="season-indicator">å¤</div>
                </div>
                
                <!-- 7æœˆ -->
                <div class="month-node summer" data-month="7" data-season="summer" onclick="selectMonth(7)" title="7æœˆæ•°æ® - ä½œç‰©å¼€èŠ±ç»“æœæœŸ">
                    <div class="month-dot"></div>
                    <div class="month-label">7æœˆ</div>
                    <div class="season-indicator">å¤</div>
                </div>
                
                <!-- 8æœˆ - å½“å‰æ¿€æ´»æœˆä»½ -->
                <div class="month-node summer active current" data-month="8" data-season="summer" onclick="selectMonth(8)" title="8æœˆæ•°æ® - ä½œç‰©æˆç†ŸæœŸï¼ˆå½“å‰æœˆä»½ï¼‰">
                    <div class="month-dot"></div>
                    <div class="month-label">8æœˆ</div>
                    <div class="season-indicator">å¤</div>
                    <div class="current-badge">å½“å‰</div>
                </div>
                
                <!-- 9æœˆ -->
                <div class="month-node autumn" data-month="9" data-season="autumn" onclick="selectMonth(9)" title="9æœˆæ•°æ® - ç§‹æ”¶å­£èŠ‚">
                    <div class="month-dot"></div>
                    <div class="month-label">9æœˆ</div>
                    <div class="season-indicator">ç§‹</div>
                </div>
                
                <!-- 10æœˆ -->
                <div class="month-node autumn" data-month="10" data-season="autumn" onclick="selectMonth(10)" title="10æœˆæ•°æ® - ä¸»è¦æ”¶è·æœŸ">
                    <div class="month-dot"></div>
                    <div class="month-label">10æœˆ</div>
                    <div class="season-indicator">ç§‹</div>
                </div>
                
                <!-- 11æœˆ -->
                <div class="month-node autumn" data-month="11" data-season="autumn" onclick="selectMonth(11)" title="11æœˆæ•°æ® - æ”¶è·å®ŒæˆæœŸ">
                    <div class="month-dot"></div>
                    <div class="month-label">11æœˆ</div>
                    <div class="season-indicator">ç§‹</div>
                </div>
                
                <!-- 12æœˆ -->
                <div class="month-node winter" data-month="12" data-season="winter" onclick="selectMonth(12)" title="12æœˆæ•°æ® - å†¬å­£ä¼‘è€•æœŸ">
                    <div class="month-dot"></div>
                    <div class="month-label">12æœˆ</div>
                    <div class="season-indicator">å†¬</div>
                </div>
            </div>
            
            <!-- å­£èŠ‚åˆ†å‰²çº¿ -->
            <div class="season-dividers">
                <div class="season-divider spring-start" style="left: 16.67%;" title="æ˜¥å­£å¼€å§‹"></div>
                <div class="season-divider summer-start" style="left: 41.67%;" title="å¤å­£å¼€å§‹"></div>
                <div class="season-divider autumn-start" style="left: 66.67%;" title="ç§‹å­£å¼€å§‹"></div>
                <div class="season-divider winter-start" style="left: 91.67%;" title="å†¬å­£å¼€å§‹"></div>
            </div>
        </div>

    </div>

    <!-- è®¾ç½®é»˜è®¤æ—¶é—´ -->
    <script>
        // é¡µé¢åŠ è½½å®Œæˆåè®¾ç½®é»˜è®¤æ—¶é—´
        document.addEventListener('DOMContentLoaded', function() {
            const now = new Date();

            // è®¾ç½®ä¸ºå½“å‰æ—¶é—´çš„æ•´ç‚¹å¾€å‰æ¨ï¼ˆä¸Šä¸€ä¸ªæ•´ç‚¹ï¼‰
            const currentHour = now.getHours();
            const previousHour = currentHour === 0 ? 23 : currentHour - 1;

            // å¦‚æœæ˜¯0ç‚¹ï¼Œéœ€è¦è®¾ç½®ä¸ºæ˜¨å¤©çš„23ç‚¹
            if (currentHour === 0) {
                now.setDate(now.getDate() - 1);
            }
            now.setHours(previousHour, 0, 0, 0); // è®¾ç½®ä¸ºæ•´ç‚¹ï¼Œåˆ†ç§’æ¸…é›¶

            // æ ¼å¼åŒ–æ—¥æœŸå’Œæ—¶é—´
            const dateStr = now.toISOString().split('T')[0]; // YYYY-MM-DD
            const timeStr = now.toTimeString().slice(0, 5); // HH:MM

            // è®¾ç½®è¾“å…¥æ¡†çš„å€¼
            const dateInput = document.getElementById('selected-date');
            const timeInput = document.getElementById('selected-time');

            if (dateInput) dateInput.value = dateStr;
            if (timeInput) timeInput.value = timeStr;

            // åˆå§‹åŒ–ä¸ƒå¤©æ°”è±¡æ•°æ®é¢æ¿
            initSevenDayWeatherPanel();
        });

        // ä¸ƒå¤©æ°”è±¡æ•°æ®é¢æ¿åŠŸèƒ½
        function initSevenDayWeatherPanel() {
            // æ•°æ®ç±»å‹åˆ‡æ¢åŠŸèƒ½
            const dataTabs = document.querySelectorAll('.data-tab');
            const chartPanels = document.querySelectorAll('.chart-panel');

            dataTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const dataType = this.getAttribute('data-type');

                    // æ›´æ–°é€‰ä¸­çŠ¶æ€
                    dataTabs.forEach(t => {
                        t.classList.remove('active');
                        t.style.background = 'rgba(255, 255, 255, 0.05)';
                        t.style.border = '1px solid rgba(255, 255, 255, 0.1)';
                    });

                    this.classList.add('active');
                    this.style.background = 'rgba(0, 212, 255, 0.2)';
                    this.style.border = '1px solid rgba(0, 212, 255, 0.5)';

                    // åˆ‡æ¢å›¾è¡¨æ˜¾ç¤º
                    chartPanels.forEach(panel => {
                        panel.style.display = 'none';
                    });

                    // æ˜¾ç¤ºå¯¹åº”çš„å›¾è¡¨
                    const targetChart = getChartPanelId(dataType);
                    const targetPanel = document.getElementById(targetChart);
                    if (targetPanel) {
                        targetPanel.style.display = 'block';
                        // åˆå§‹åŒ–å¯¹åº”çš„å›¾è¡¨
                        initChart(dataType);
                    }

                    // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
                    updateStatistics(dataType);
                });
            });

            // åˆå§‹åŒ–é»˜è®¤å›¾è¡¨ï¼ˆå¤©æ°”é¢„æµ‹ï¼‰
            initChart('weather');
            updateStatistics('weather');
        }

        function getChartPanelId(dataType) {
            const mapping = {
                'weather': 'weather-forecast-chart',
                'precipitation': 'precipitation-chart',
                'temperature': 'temperature-chart',
                'soil-temp': 'soil-temp-chart',
                'accumulated-temp': 'accumulated-temp-chart',
                'accumulated-rain': 'accumulated-rain-chart',
                'humidity': 'humidity-chart'
            };
            return mapping[dataType] || 'weather-forecast-chart';
        }

        function initChart(dataType) {
            // è°ƒç”¨weather-monitoring.jsä¸­çš„å›¾è¡¨åˆå§‹åŒ–å‡½æ•°
            if (typeof initSevenDayDataChart === 'function') {
                initSevenDayDataChart(dataType);
            } else {
                console.log('åˆå§‹åŒ–å›¾è¡¨:', dataType);
            }
        }

        function updateStatistics(dataType) {
            // æ ¹æ®æ•°æ®ç±»å‹ç”Ÿæˆç»Ÿè®¡ä¿¡æ¯
            const mockStats = {
                'weather': { avg: 'å¤šäº‘', max: 'æ™´å¤©', min: 'é˜´å¤©', trend: 'è½¬æ™´' },
                'precipitation': { avg: '11.9mm', max: '25.0mm', min: '0.0mm', trend: 'æ³¢åŠ¨' },
                'temperature': { avg: '19.1Â°C', max: '28.0Â°C', min: '6.0Â°C', trend: 'å›å‡' },
                'soil-temp': { avg: '16.6Â°C', max: '20.0Â°C', min: '12.0Â°C', trend: 'ç¨³å®š' },
                'accumulated-temp': { avg: '2232Â°CÂ·æ—¥', max: '2292Â°CÂ·æ—¥', min: '2156Â°CÂ·æ—¥', trend: 'æŒç»­ç´¯ç§¯' },
                'accumulated-rain': { avg: '81.7mm', max: '113mm', min: '45mm', trend: 'é€æ­¥å¢åŠ ' },
                'humidity': { avg: '66.4%', max: '82%', min: '45%', trend: 'æ³¢åŠ¨ä¸Šå‡' }
            };

            const stats = mockStats[dataType] || mockStats['weather'];

            document.getElementById('stat-avg').textContent = `å¹³å‡å€¼: ${stats.avg}`;
            document.getElementById('stat-max').textContent = `æœ€é«˜: ${stats.max}`;
            document.getElementById('stat-min').textContent = `æœ€ä½: ${stats.min}`;
            document.getElementById('stat-trend').textContent = `è¶‹åŠ¿: ${stats.trend}`;
        }
    </script>

    <!-- å¼•å…¥JavaScriptæ–‡ä»¶ -->
    <script src="assets/js/cesium-config.js"></script>
    <script src="assets/js/cesium-map.js"></script>
    <script src="assets/js/crop-layers.js"></script>
    <script src="assets/js/township-blocks.js"></script>
    <script src="assets/js/timeline.js"></script>
    <script src="assets/js/device-monitoring.js"></script>
    <script src="assets/js/main.js"></script>
    <script src="assets/js/dashboard-charts.js"></script>
    <script src="assets/js/weather-monitoring.js"></script>
</body>
</html>