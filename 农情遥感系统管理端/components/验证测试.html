<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ä¾§è¾¹æ ç»„ä»¶éªŒè¯æµ‹è¯•</title>
  <link rel="stylesheet" href="../assets/css/common.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <style>
    .test-container {
      max-width: 1200px;
      margin: 20px auto;
      padding: 20px;
      background: #f5f5f5;
      border-radius: 8px;
    }
    
    .test-section {
      background: white;
      margin: 20px 0;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .test-title {
      color: #2c3e50;
      border-bottom: 2px solid #3498db;
      padding-bottom: 10px;
      margin-bottom: 20px;
    }
    
    .test-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      margin: 10px 0;
      background: #f8f9fa;
      border-radius: 4px;
      border-left: 4px solid #dee2e6;
    }
    
    .test-item.success {
      border-left-color: #28a745;
      background: #d4edda;
    }
    
    .test-item.error {
      border-left-color: #dc3545;
      background: #f8d7da;
    }
    
    .test-status {
      font-weight: bold;
    }
    
    .success { color: #28a745; }
    .error { color: #dc3545; }
    .pending { color: #ffc107; }
    
    .page-links {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-top: 20px;
    }
    
    .page-link {
      display: block;
      padding: 15px;
      text-align: center;
      background: #007bff;
      color: white;
      text-decoration: none;
      border-radius: 8px;
      transition: background-color 0.3s;
    }
    
    .page-link:hover {
      background: #0056b3;
      color: white;
    }
    
    .sidebar-preview {
      width: 250px;
      height: 400px;
      overflow-y: auto;
      border: 1px solid #ddd;
      border-radius: 8px;
      margin: 20px 0;
    }
  </style>
</head>
<body>
  <!-- é¡¶éƒ¨å¯¼èˆª -->
  <header class="admin-header">
    <div class="header-content">
      <div class="header-left">
        <h1 class="header-title">ä¾§è¾¹æ ç»„ä»¶éªŒè¯æµ‹è¯•</h1>
      </div>
      <div class="header-right">
        <div class="user-info">
          <i class="fas fa-user"></i>
          <span>æµ‹è¯•ç”¨æˆ·</span>
        </div>
      </div>
    </div>
  </header>

  <!-- ä¸»ä½“å¸ƒå±€ -->
  <div class="admin-layout">
    <!-- å·¦ä¾§èœå• - ä½¿ç”¨ç»„ä»¶ -->
    <aside class="admin-sidebar">
      <!-- ä¾§è¾¹æ å†…å®¹å°†ç”±ç»„ä»¶åŠ¨æ€åŠ è½½ -->
    </aside>

    <!-- ä¾§è¾¹æ åˆ‡æ¢æŒ‰é’® -->
    <button class="sidebar-toggle">
      <i class="fas fa-angle-left"></i>
    </button>

    <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
    <main class="admin-main">
      <div class="test-container">
        
        <!-- æµ‹è¯•æ ‡é¢˜ -->
        <h1 style="text-align: center; color: #2c3e50; margin-bottom: 30px;">
          <i class="fas fa-check-circle"></i>
          ä¾§è¾¹æ ç»„ä»¶åŒ–éªŒè¯æµ‹è¯•
        </h1>

        <!-- ç»„ä»¶åŠ è½½æµ‹è¯• -->
        <div class="test-section">
          <h2 class="test-title">
            <i class="fas fa-cogs"></i>
            ç»„ä»¶åŠ è½½æµ‹è¯•
          </h2>
          <div id="component-tests">
            <div class="test-item pending" id="test-component-load">
              <span>ç»„ä»¶æ˜¯å¦æˆåŠŸåŠ è½½</span>
              <span class="test-status pending">æ£€æµ‹ä¸­...</span>
            </div>
            <div class="test-item pending" id="test-sidebar-render">
              <span>ä¾§è¾¹æ æ˜¯å¦æ­£ç¡®æ¸²æŸ“</span>
              <span class="test-status pending">æ£€æµ‹ä¸­...</span>
            </div>
            <div class="test-item pending" id="test-navigation-setup">
              <span>å¯¼èˆªé“¾æ¥æ˜¯å¦æ­£ç¡®è®¾ç½®</span>
              <span class="test-status pending">æ£€æµ‹ä¸­...</span>
            </div>
            <div class="test-item pending" id="test-active-state">
              <span>å½“å‰é¡µé¢æ´»åŠ¨çŠ¶æ€</span>
              <span class="test-status pending">æ£€æµ‹ä¸­...</span>
            </div>
          </div>
        </div>

        <!-- åŠŸèƒ½æµ‹è¯• -->
        <div class="test-section">
          <h2 class="test-title">
            <i class="fas fa-mouse-pointer"></i>
            äº¤äº’åŠŸèƒ½æµ‹è¯•
          </h2>
          <div id="interaction-tests">
            <div class="test-item pending" id="test-sidebar-toggle">
              <span>ä¾§è¾¹æ æŠ˜å /å±•å¼€åŠŸèƒ½</span>
              <button onclick="testSidebarToggle()" class="btn btn-sm btn-primary">æµ‹è¯•</button>
            </div>
            <div class="test-item pending" id="test-responsive">
              <span>å“åº”å¼å¸ƒå±€é€‚é…</span>
              <button onclick="testResponsive()" class="btn btn-sm btn-primary">æµ‹è¯•</button>
            </div>
          </div>
        </div>

        <!-- é¡µé¢å¯¼èˆªæµ‹è¯• -->
        <div class="test-section">
          <h2 class="test-title">
            <i class="fas fa-sitemap"></i>
            é¡µé¢å¯¼èˆªæµ‹è¯•
          </h2>
          <p>ç‚¹å‡»ä»¥ä¸‹é“¾æ¥æµ‹è¯•å„é¡µé¢çš„ä¾§è¾¹æ ç»„ä»¶æ˜¯å¦æ­£å¸¸å·¥ä½œï¼š</p>
          <div class="page-links">
            <a href="../pages/dashboard/dashboard.html" class="page-link">
              <i class="fas fa-tachometer-alt"></i><br>
              ä»ªè¡¨ç›˜é¡µé¢
            </a>
            <a href="../pages/data-management/data-overview/data-overview.html" class="page-link">
              <i class="fas fa-chart-bar"></i><br>
              æ•°æ®æ¦‚è§ˆé¡µé¢
            </a>
            <a href="../pages/data-management/remote-sensing/list.html" class="page-link">
              <i class="fas fa-satellite"></i><br>
              é¥æ„Ÿæ•°æ®åˆ—è¡¨
            </a>
            <a href="../pages/data-management/remote-sensing/import.html" class="page-link">
              <i class="fas fa-upload"></i><br>
              é¥æ„Ÿæ•°æ®å¯¼å…¥
            </a>
            <a href="../pages/data-management/farmland/list.html" class="page-link">
              <i class="fas fa-seedling"></i><br>
              å†œç”°æ•°æ®åˆ—è¡¨
            </a>
            <a href="../pages/data-management/farmland/crops.html" class="page-link">
              <i class="fas fa-leaf"></i><br>
              å†œä½œç‰©ç®¡ç†
            </a>
            <a href="../pages/device-management/monitor/monitor.html" class="page-link">
              <i class="fas fa-desktop"></i><br>
              è®¾å¤‡ç®¡ç†
            </a>
            <a href="../pages/device-management/detail/detail.html" class="page-link">
              <i class="fas fa-info-circle"></i><br>
              è®¾å¤‡è¯¦æƒ…
            </a>
          </div>
        </div>

        <!-- ä¾§è¾¹æ é¢„è§ˆ -->
        <div class="test-section">
          <h2 class="test-title">
            <i class="fas fa-eye"></i>
            ä¾§è¾¹æ é¢„è§ˆ
          </h2>
          <div class="sidebar-preview" id="sidebar-preview">
            <!-- ä¾§è¾¹æ å†…å®¹é¢„è§ˆå°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
          </div>
        </div>

        <!-- æµ‹è¯•ç»“æœæ€»ç»“ -->
        <div class="test-section">
          <h2 class="test-title">
            <i class="fas fa-clipboard-check"></i>
            æµ‹è¯•ç»“æœæ€»ç»“
          </h2>
          <div id="test-summary">
            <div id="summary-content">æµ‹è¯•è¿›è¡Œä¸­...</div>
          </div>
        </div>

      </div>
    </main>
  </div>

  <!-- è„šæœ¬æ–‡ä»¶ -->
  <script src="../assets/js/common.js"></script>
  <script src="sidebar.js"></script>
  <script>
    // æµ‹è¯•è„šæœ¬
    let testResults = {};

    // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œæµ‹è¯•
    document.addEventListener('DOMContentLoaded', function() {
      setTimeout(() => {
        runAllTests();
      }, 1000); // ç­‰å¾…ç»„ä»¶å®Œå…¨åŠ è½½
    });

    function runAllTests() {
      console.log('å¼€å§‹è¿è¡Œç»„ä»¶éªŒè¯æµ‹è¯•...');

      // æµ‹è¯•1: ç»„ä»¶æ˜¯å¦æˆåŠŸåŠ è½½
      testComponentLoad();
      
      // æµ‹è¯•2: ä¾§è¾¹æ æ˜¯å¦æ­£ç¡®æ¸²æŸ“
      testSidebarRender();
      
      // æµ‹è¯•3: å¯¼èˆªé“¾æ¥æ˜¯å¦æ­£ç¡®è®¾ç½®
      testNavigationSetup();
      
      // æµ‹è¯•4: å½“å‰é¡µé¢æ´»åŠ¨çŠ¶æ€
      testActiveState();

      // ç”Ÿæˆæµ‹è¯•æ€»ç»“
      setTimeout(generateTestSummary, 2000);
    }

    function testComponentLoad() {
      const testItem = document.getElementById('test-component-load');
      const statusEl = testItem.querySelector('.test-status');
      
      // æ£€æŸ¥ Sidebar ç±»æ˜¯å¦å­˜åœ¨
      if (typeof Sidebar !== 'undefined') {
        updateTestStatus(testItem, statusEl, true, 'âœ… ç»„ä»¶åŠ è½½æˆåŠŸ');
        testResults.componentLoad = true;
      } else {
        updateTestStatus(testItem, statusEl, false, 'âŒ ç»„ä»¶åŠ è½½å¤±è´¥');
        testResults.componentLoad = false;
      }
    }

    function testSidebarRender() {
      const testItem = document.getElementById('test-sidebar-render');
      const statusEl = testItem.querySelector('.test-status');
      
      // æ£€æŸ¥ä¾§è¾¹æ æ˜¯å¦è¢«æ­£ç¡®æ¸²æŸ“
      const sidebarContent = document.querySelector('.admin-sidebar .sidebar-content');
      if (sidebarContent) {
        updateTestStatus(testItem, statusEl, true, 'âœ… ä¾§è¾¹æ æ¸²æŸ“æˆåŠŸ');
        testResults.sidebarRender = true;
        
        // æ˜¾ç¤ºä¾§è¾¹æ é¢„è§ˆ
        const preview = document.getElementById('sidebar-preview');
        preview.innerHTML = sidebarContent.outerHTML;
      } else {
        updateTestStatus(testItem, statusEl, false, 'âŒ ä¾§è¾¹æ æ¸²æŸ“å¤±è´¥');
        testResults.sidebarRender = false;
      }
    }

    function testNavigationSetup() {
      const testItem = document.getElementById('test-navigation-setup');
      const statusEl = testItem.querySelector('.test-status');
      
      // æ£€æŸ¥å¯¼èˆªé“¾æ¥æ•°é‡
      const navLinks = document.querySelectorAll('.admin-sidebar .nav-link');
      if (navLinks.length > 0) {
        updateTestStatus(testItem, statusEl, true, `âœ… æ‰¾åˆ° ${navLinks.length} ä¸ªå¯¼èˆªé“¾æ¥`);
        testResults.navigationSetup = true;
      } else {
        updateTestStatus(testItem, statusEl, false, 'âŒ æœªæ‰¾åˆ°å¯¼èˆªé“¾æ¥');
        testResults.navigationSetup = false;
      }
    }

    function testActiveState() {
      const testItem = document.getElementById('test-active-state');
      const statusEl = testItem.querySelector('.test-status');
      
      // æ£€æŸ¥æ˜¯å¦æœ‰æ´»åŠ¨çŠ¶æ€çš„å¯¼èˆªé¡¹
      const activeNavItem = document.querySelector('.admin-sidebar .nav-item.active');
      if (activeNavItem) {
        const activeText = activeNavItem.querySelector('.nav-text')?.textContent || 'æœªçŸ¥';
        updateTestStatus(testItem, statusEl, true, `âœ… å½“å‰é¡µé¢: ${activeText}`);
        testResults.activeState = true;
      } else {
        updateTestStatus(testItem, statusEl, false, 'âŒ æœªæ‰¾åˆ°æ´»åŠ¨çŠ¶æ€');
        testResults.activeState = false;
      }
    }

    function testSidebarToggle() {
      const testItem = document.getElementById('test-sidebar-toggle');
      const statusEl = testItem.querySelector('.test-status');
      
      const toggleBtn = document.querySelector('.sidebar-toggle');
      const sidebar = document.querySelector('.admin-sidebar');
      
      if (toggleBtn && sidebar) {
        // è§¦å‘ç‚¹å‡»äº‹ä»¶
        toggleBtn.click();
        
        setTimeout(() => {
          // æ£€æŸ¥ä¾§è¾¹æ çŠ¶æ€æ˜¯å¦æ”¹å˜
          const isCollapsed = sidebar.classList.contains('collapsed');
          updateTestStatus(testItem, statusEl, true, `âœ… ä¾§è¾¹æ çŠ¶æ€: ${isCollapsed ? 'æ”¶èµ·' : 'å±•å¼€'}`);
          testResults.sidebarToggle = true;
        }, 500);
      } else {
        updateTestStatus(testItem, statusEl, false, 'âŒ æŠ˜å æŒ‰é’®æœªæ‰¾åˆ°');
        testResults.sidebarToggle = false;
      }
    }

    function testResponsive() {
      const testItem = document.getElementById('test-responsive');
      const statusEl = testItem.querySelector('.test-status');
      
      // æ¨¡æ‹Ÿç§»åŠ¨ç«¯è§†å£
      const originalWidth = window.innerWidth;
      
      // æ£€æŸ¥å“åº”å¼æ ·å¼
      const sidebar = document.querySelector('.admin-sidebar');
      if (sidebar) {
        const computedStyle = window.getComputedStyle(sidebar);
        updateTestStatus(testItem, statusEl, true, 'âœ… å“åº”å¼æ ·å¼æ­£å¸¸');
        testResults.responsive = true;
      } else {
        updateTestStatus(testItem, statusEl, false, 'âŒ å“åº”å¼æµ‹è¯•å¤±è´¥');
        testResults.responsive = false;
      }
    }

    function updateTestStatus(testItem, statusEl, success, message) {
      testItem.className = `test-item ${success ? 'success' : 'error'}`;
      statusEl.className = `test-status ${success ? 'success' : 'error'}`;
      statusEl.textContent = message;
    }

    function generateTestSummary() {
      const summaryContent = document.getElementById('summary-content');
      const totalTests = Object.keys(testResults).length;
      const passedTests = Object.values(testResults).filter(result => result === true).length;
      const failedTests = totalTests - passedTests;
      
      const successRate = totalTests > 0 ? Math.round((passedTests / totalTests) * 100) : 0;
      
      summaryContent.innerHTML = `
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 20px; text-align: center;">
          <div>
            <h3 style="color: #28a745; margin: 0;">é€šè¿‡æµ‹è¯•</h3>
            <div style="font-size: 2em; font-weight: bold; color: #28a745;">${passedTests}</div>
          </div>
          <div>
            <h3 style="color: #dc3545; margin: 0;">å¤±è´¥æµ‹è¯•</h3>
            <div style="font-size: 2em; font-weight: bold; color: #dc3545;">${failedTests}</div>
          </div>
          <div>
            <h3 style="color: #2c3e50; margin: 0;">æˆåŠŸç‡</h3>
            <div style="font-size: 2em; font-weight: bold; color: ${successRate >= 80 ? '#28a745' : '#dc3545'};">${successRate}%</div>
          </div>
        </div>
        <div style="margin-top: 20px; padding: 15px; background: ${successRate >= 80 ? '#d4edda' : '#f8d7da'}; border-radius: 8px; text-align: center;">
          <strong>${successRate >= 80 ? 'ğŸ‰ ä¾§è¾¹æ ç»„ä»¶åŒ–æˆåŠŸï¼' : 'âš ï¸ éœ€è¦æ£€æŸ¥å’Œä¿®å¤é—®é¢˜'}</strong>
        </div>
      `;
    }

    // æ·»åŠ æ§åˆ¶å°æ—¥å¿—
    console.log('ä¾§è¾¹æ ç»„ä»¶éªŒè¯æµ‹è¯•é¡µé¢å·²åŠ è½½');
  </script>
</body>
</html>