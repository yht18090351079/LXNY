<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iframe æµ‹è¯•é¡µé¢</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-container { border: 2px solid #ccc; margin: 10px 0; padding: 10px; }
        .test-title { font-weight: bold; color: #333; }
        iframe { width: 100%; height: 300px; border: 1px solid #999; }
        .info { background: #f0f8ff; padding: 10px; margin: 5px 0; border-radius: 4px; }
        .error { background: #ffe4e1; padding: 10px; margin: 5px 0; border-radius: 4px; }
        .success { background: #f0fff0; padding: 10px; margin: 5px 0; border-radius: 4px; }
        button { margin: 5px; padding: 8px 16px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #45a049; }
        .log { background: #f5f5f5; padding: 10px; margin: 5px 0; border-radius: 4px; font-family: monospace; font-size: 12px; max-height: 150px; overflow-y: auto; }
    </style>
</head>
<body>
    <h1>ğŸ” iframe è·¯å¾„è¯Šæ–­æµ‹è¯•</h1>
    
    <div class="info">
        <strong>å½“å‰è®¿é—®åœ°å€ï¼š</strong><span id="currentUrl"></span><br>
        <strong>æœåŠ¡å™¨IPï¼š</strong>192.168.101.16:3000<br>
        <strong>æµ‹è¯•æ—¶é—´ï¼š</strong><span id="currentTime"></span>
    </div>

    <div class="test-container">
        <div class="test-title">æµ‹è¯•1: ç›´æ¥è®¿é—® /prototype/index.html</div>
        <iframe id="iframe1" src="/prototype/index.html"></iframe>
        <div class="info">çŠ¶æ€: <span id="status1">åŠ è½½ä¸­...</span></div>
    </div>

    <div class="test-container">
        <div class="test-title">æµ‹è¯•2: è®¿é—® /index.html (ä¼šé‡å®šå‘)</div>
        <iframe id="iframe2" src="/index.html"></iframe>
        <div class="info">çŠ¶æ€: <span id="status2">åŠ è½½ä¸­...</span></div>
    </div>

    <div class="test-container">
        <div class="test-title">æµ‹è¯•3: åŠ¨æ€è®¾ç½®è·¯å¾„</div>
        <iframe id="iframe3"></iframe>
        <button onclick="setPath3('/prototype/index.html')">è®¾ç½® /prototype/index.html</button>
        <button onclick="setPath3('/index.html')">è®¾ç½® /index.html</button>
        <button onclick="setPath3('../../å¤§å±åŸå‹/index.html')">è®¾ç½®ç›¸å¯¹è·¯å¾„</button>
        <div class="info">çŠ¶æ€: <span id="status3">æœªè®¾ç½®</span></div>
    </div>

    <div class="test-container">
        <div class="test-title">ç½‘ç»œè¯·æ±‚æ—¥å¿—</div>
        <div id="networkLog" class="log"></div>
        <button onclick="clearLog()">æ¸…é™¤æ—¥å¿—</button>
        <button onclick="testAllPaths()">æµ‹è¯•æ‰€æœ‰è·¯å¾„</button>
    </div>

    <script>
        // æ˜¾ç¤ºå½“å‰URLå’Œæ—¶é—´
        document.getElementById('currentUrl').textContent = window.location.href;
        document.getElementById('currentTime').textContent = new Date().toLocaleString();

        // æ—¥å¿—å‡½æ•°
        function log(message) {
            const logElement = document.getElementById('networkLog');
            const timestamp = new Date().toLocaleTimeString();
            logElement.innerHTML += `[${timestamp}] ${message}<br>`;
            logElement.scrollTop = logElement.scrollHeight;
            console.log(message);
        }

        function clearLog() {
            document.getElementById('networkLog').innerHTML = '';
        }

        // iframe åŠ è½½çŠ¶æ€ç›‘æ§
        function setupIframeMonitoring(iframeId, statusId) {
            const iframe = document.getElementById(iframeId);
            const status = document.getElementById(statusId);
            
            iframe.onload = function() {
                try {
                    const src = iframe.src;
                    status.textContent = `âœ… åŠ è½½æˆåŠŸ - ${src}`;
                    status.className = 'success';
                    log(`${iframeId}: åŠ è½½æˆåŠŸ - ${src}`);
                } catch (e) {
                    status.textContent = `âš ï¸ åŠ è½½å®Œæˆä½†å¯èƒ½æœ‰è·¨åŸŸé—®é¢˜`;
                    status.className = 'info';
                    log(`${iframeId}: åŠ è½½å®Œæˆï¼Œè·¨åŸŸé™åˆ¶`);
                }
            };
            
            iframe.onerror = function() {
                status.textContent = `âŒ åŠ è½½å¤±è´¥ - ${iframe.src}`;
                status.className = 'error';
                log(`${iframeId}: åŠ è½½å¤±è´¥ - ${iframe.src}`);
            };
        }

        // è®¾ç½®ç¬¬ä¸‰ä¸ªiframeçš„è·¯å¾„
        function setPath3(path) {
            const iframe = document.getElementById('iframe3');
            const status = document.getElementById('status3');
            iframe.src = path;
            status.textContent = `è®¾ç½®è·¯å¾„: ${path}`;
            log(`iframe3: è®¾ç½®æ–°è·¯å¾„ - ${path}`);
        }

        // æµ‹è¯•æ‰€æœ‰è·¯å¾„
        async function testAllPaths() {
            const paths = [
                '/prototype/index.html',
                '/index.html',
                '/å¤§å±åŸå‹/index.html',
                '../../å¤§å±åŸå‹/index.html'
            ];

            log('å¼€å§‹æµ‹è¯•æ‰€æœ‰è·¯å¾„...');
            
            for (const path of paths) {
                try {
                    const response = await fetch(path, { method: 'HEAD' });
                    log(`${path}: ${response.status} ${response.statusText}`);
                    if (response.redirected) {
                        log(`  é‡å®šå‘åˆ°: ${response.url}`);
                    }
                } catch (error) {
                    log(`${path}: è¯·æ±‚å¤±è´¥ - ${error.message}`);
                }
            }
        }

        // åˆå§‹åŒ–ç›‘æ§
        setupIframeMonitoring('iframe1', 'status1');
        setupIframeMonitoring('iframe2', 'status2');
        setupIframeMonitoring('iframe3', 'status3');

        // é¡µé¢åŠ è½½å®Œæˆåçš„æµ‹è¯•
        window.addEventListener('load', function() {
            log('é¡µé¢åŠ è½½å®Œæˆï¼Œå¼€å§‹ç›‘æ§iframeçŠ¶æ€...');
            setTimeout(testAllPaths, 2000); // 2ç§’åè‡ªåŠ¨æµ‹è¯•æ‰€æœ‰è·¯å¾„
        });
    </script>
</body>
</html>