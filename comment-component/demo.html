<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¯„è®ºç³»ç»Ÿç»„ä»¶ - æ¼”ç¤ºé¡µé¢</title>
    <link rel="stylesheet" href="comment-system.css">
    <style>
        /* æ¼”ç¤ºé¡µé¢ä¸“ç”¨æ ·å¼ */
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .demo-container {
            padding: 40px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .demo-header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }

        .demo-title {
            font-size: 32px;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .demo-subtitle {
            font-size: 16px;
            opacity: 0.8;
            margin-bottom: 30px;
        }

        .demo-instructions {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
            margin-bottom: 30px;
        }

        .demo-instructions h3 {
            margin-top: 0;
            color: white;
            font-size: 18px;
        }

        .demo-instructions ul {
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.6;
        }

        .demo-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        .demo-card {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .demo-card:hover {
            transform: translateY(-5px);
        }

        .demo-card h3 {
            color: #333;
            margin-top: 0;
            font-size: 20px;
            margin-bottom: 15px;
        }

        .demo-card p {
            color: #666;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .feature-list {
            list-style: none;
            padding: 0;
        }

        .feature-list li {
            padding: 8px 0;
            color: #555;
            position: relative;
            padding-left: 25px;
        }

        .feature-list li:before {
            content: 'âœ“';
            position: absolute;
            left: 0;
            color: #28a745;
            font-weight: bold;
        }

        .demo-actions {
            text-align: center;
            margin-top: 30px;
        }

        .demo-btn {
            display: inline-block;
            padding: 12px 24px;
            background: #007bff;
            color: white;
            text-decoration: none;
            border-radius: 6px;
            margin: 0 10px;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            font-size: 14px;
        }

        .demo-btn:hover {
            background: #0056b3;
            transform: translateY(-2px);
        }

        .demo-btn.secondary {
            background: #6c757d;
        }

        .demo-btn.secondary:hover {
            background: #545b62;
        }

        .demo-mockup {
            background: #f8f9fa;
            border: 2px dashed #dee2e6;
            border-radius: 8px;
            padding: 40px;
            text-align: center;
            color: #6c757d;
            margin: 20px 0;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .mockup-icon {
            font-size: 48px;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        .mockup-text {
            font-size: 16px;
            margin-bottom: 10px;
        }

        .mockup-hint {
            font-size: 12px;
            color: #adb5bd;
        }



        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .demo-content {
                grid-template-columns: 1fr;
            }
            
            .demo-container {
                padding: 20px;
            }
            
            .demo-title {
                font-size: 24px;
            }
            

        }

        /* çŠ¶æ€æŒ‡ç¤ºå™¨ */
        .status-indicator {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.9);
            padding: 10px 15px;
            border-radius: 20px;
            font-size: 12px;
            color: #333;
            backdrop-filter: blur(10px);
            z-index: 998;
        }

        .status-dot {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #28a745;
            margin-right: 8px;
            animation: pulse-dot 2s infinite;
        }

        @keyframes pulse-dot {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
    </style>
</head>
<body>
    <!-- çŠ¶æ€æŒ‡ç¤ºå™¨ -->
    <div class="status-indicator">
        <span class="status-dot"></span>
        è¯„è®ºç³»ç»Ÿå·²åŠ è½½
    </div>



    <div class="demo-container">
        <!-- æ¼”ç¤ºé¡µé¢æ ‡é¢˜ -->
        <div class="demo-header">
            <h1 class="demo-title">è¯„è®ºç³»ç»Ÿç»„ä»¶æ¼”ç¤º</h1>
            <p class="demo-subtitle">ç±»ä¼¼ Axure / å¢¨åˆ€ çš„è¯„è®ºåŠŸèƒ½ï¼Œæ”¯æŒåœ¨é¡µé¢ä»»æ„ä½ç½®æ·»åŠ è¯„è®ºæ ‡è®°</p>
            
            <div class="demo-instructions">
                <h3>ğŸ“ ä½¿ç”¨è¯´æ˜</h3>
                <ul>
                    <li><strong>æ­¥éª¤1ï¼š</strong>ç‚¹å‡»å³ä¸Šè§’"ğŸ’¬ è¯„è®ºæ¨¡å¼"æŒ‰é’®è¿›å…¥è¯„è®ºæ¨¡å¼ï¼ˆæŒ‰é’®ä¼šå˜è“è‰²ï¼‰</li>
                    <li><strong>æ­¥éª¤2ï¼š</strong>åœ¨è¯„è®ºæ¨¡å¼ä¸‹ï¼Œç‚¹å‡»é¡µé¢ä»»æ„ä½ç½®æ·»åŠ è¯„è®º</li>
                    <li><strong>æŸ¥çœ‹è¯„è®ºï¼š</strong>ç‚¹å‡»è¯„è®ºæ ‡è®°æŸ¥çœ‹è¯¦æƒ…ï¼Œç‚¹å‡»è¯„è®ºåˆ—è¡¨é¡¹ä¹Ÿå¯æŸ¥çœ‹</li>
                    <li><strong>æ§åˆ¶æ˜¾ç¤ºï¼š</strong>ä½¿ç”¨"ğŸ‘ï¸ æ˜¾ç¤º/éšè—è¯„è®º"æŒ‰é’®æ§åˆ¶è¯„è®ºæ ‡è®°çš„å¯è§æ€§</li>
                    <li><strong>è¯„è®ºåˆ—è¡¨ï¼š</strong>ç‚¹å‡»"ğŸ“‹ è¯„è®ºåˆ—è¡¨"æŒ‰é’®æŸ¥çœ‹æ‰€æœ‰è¯„è®º</li>
                    <li><strong>é€€å‡ºæ¨¡å¼ï¼š</strong>å†æ¬¡ç‚¹å‡»"è¯„è®ºæ¨¡å¼"æŒ‰é’®é€€å‡ºè¯„è®ºæ¨¡å¼</li>
                    <li><strong>å¿«æ·é”®ï¼š</strong>æŒ‰ESCé”®å¯å…³é—­å¼¹çª—å’Œæ¨¡æ€æ¡†</li>
                </ul>
            </div>
        </div>

        <!-- æ¼”ç¤ºå†…å®¹åŒºåŸŸ -->
        <div class="demo-content">
            <div class="demo-card">
                <h3>ğŸ¯ æ ¸å¿ƒåŠŸèƒ½</h3>
                <p>è¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„è¯„è®ºç³»ç»Ÿç»„ä»¶ï¼Œæ‚¨å¯ä»¥åœ¨è¿™é‡Œæµ‹è¯•å„ç§åŠŸèƒ½ã€‚</p>
                <ul class="feature-list">
                    <li>ç‚¹å‡»æ·»åŠ è¯„è®ºæ ‡è®°</li>
                    <li>è¯„è®ºç¼–è¾‘å’Œåˆ é™¤</li>
                    <li>ä¼˜å…ˆçº§è®¾ç½®ï¼ˆä½/æ™®é€š/é«˜/ç´§æ€¥ï¼‰</li>
                    <li>çŠ¶æ€ç®¡ç†ï¼ˆæœªè§£å†³/å·²è§£å†³ï¼‰</li>
                    <li>å›å¤åŠŸèƒ½</li>
                    <li>æœ¬åœ°å­˜å‚¨</li>
                </ul>
            </div>

            <div class="demo-card">
                <h3>ğŸ’¡ è®¾è®¡ç‰¹ç‚¹</h3>
                <p>å‚è€ƒäº† Axure å’Œå¢¨åˆ€çš„è¯„è®ºåŠŸèƒ½è®¾è®¡ï¼Œæä¾›ç›´è§‚çš„ç”¨æˆ·ä½“éªŒã€‚</p>
                <ul class="feature-list">
                    <li>ç°ä»£åŒ–çš„ UI è®¾è®¡</li>
                    <li>å“åº”å¼å¸ƒå±€</li>
                    <li>æµç•…çš„åŠ¨ç”»æ•ˆæœ</li>
                    <li>å®Œå–„çš„äº¤äº’åé¦ˆ</li>
                    <li>ESCé”®å…³é—­å¼¹çª—</li>
                    <li>ç§»åŠ¨ç«¯é€‚é…</li>
                </ul>
            </div>
        </div>

        <!-- æµ‹è¯•åŒºåŸŸ -->
        <div class="demo-mockup">
            <div class="mockup-icon">ğŸ–±ï¸</div>
            <div class="mockup-text">åœ¨è¿™ä¸ªåŒºåŸŸæµ‹è¯•è¯„è®ºåŠŸèƒ½</div>
            <div class="mockup-hint">è¿›å…¥è¯„è®ºæ¨¡å¼åï¼Œç‚¹å‡»ä»»æ„ä½ç½®æ·»åŠ è¯„è®º</div>
        </div>

        <!-- æ“ä½œæŒ‰é’® -->
        <div class="demo-actions">
            <button class="demo-btn" onclick="window.commentSystem.openPanel()">
                ğŸ“‹ æ‰“å¼€è¯„è®ºåˆ—è¡¨
            </button>
            <button class="demo-btn" onclick="saveToFile()" id="save-btn">
                ğŸ’¾ ä¿å­˜åˆ°æ–‡ä»¶
            </button>
            <button class="demo-btn secondary" onclick="loadFromFile()">
                ğŸ“‚ ä»æ–‡ä»¶åŠ è½½
            </button>
            <button class="demo-btn secondary" onclick="exportComments()">
                ğŸ“¤ å¯¼å‡ºæ•°æ®
            </button>
            <button class="demo-btn secondary" onclick="addSampleComments()">
                ğŸ“ æ·»åŠ ç¤ºä¾‹è¯„è®º
            </button>
            <button class="demo-btn secondary" onclick="fixCommentData()">
                ğŸ”§ ä¿®å¤æ•°æ®
            </button>
            <button class="demo-btn secondary" onclick="clearAllComments()">
                ğŸ—‘ï¸ æ¸…ç©ºæ‰€æœ‰è¯„è®º
            </button>
            <button class="demo-btn secondary" onclick="window.commentSystem.updateAllMarkerPositions(); console.log('âœ… å·²å¼ºåˆ¶æ›´æ–°æ‰€æœ‰æ ‡è®°ä½ç½®');">
                ğŸ“ åˆ·æ–°æ ‡è®°ä½ç½®
            </button>
        </div>
    </div>

    <!-- è¯„è®ºç³»ç»Ÿç»„ä»¶ -->
    <div id="comment-system">
        <!-- è¯„è®ºå·¥å…·æ  -->
        <div class="comment-toolbar">
            <button id="toggle-comment-mode" class="toolbar-btn">
                <span class="btn-icon">ğŸ’¬</span>
                <span class="btn-text">è¯„è®ºæ¨¡å¼</span>
            </button>
            <button id="toggle-comments-visibility" class="toolbar-btn">
                <span class="btn-icon">ğŸ‘ï¸</span>
                <span class="btn-text">æ˜¾ç¤ºè¯„è®º</span>
            </button>
            <button id="open-comment-list" class="toolbar-btn">
                <span class="btn-icon">ğŸ“‹</span>
                <span class="btn-text">è¯„è®ºåˆ—è¡¨</span>
            </button>

        </div>

        <!-- è¯„è®ºæ ‡è®°å®¹å™¨ -->
        <div id="comment-markers"></div>

        <!-- è¯„è®ºé¢æ¿ -->
        <div id="comment-panel" class="comment-panel">
            <div class="panel-header">
                <h3 class="panel-title">è¯„è®ºåˆ—è¡¨</h3>
                <button id="close-panel" class="close-btn">&times;</button>
            </div>
            <div class="panel-content">
                <div id="comments-list" class="comments-list">
                    <!-- è¯„è®ºé¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€æ·»åŠ  -->
                </div>
            </div>
        </div>

        <!-- è¯„è®ºç¼–è¾‘æ¨¡æ€æ¡† -->
        <div id="comment-modal" class="comment-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 id="modal-title">æ·»åŠ è¯„è®º</h4>
                    <button id="close-modal" class="close-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="comment-author">ä½œè€…:</label>
                        <input type="text" id="comment-author" placeholder="è¯·è¾“å…¥æ‚¨çš„å§“å" value="åŒ¿åç”¨æˆ·">
                    </div>
                    <div class="form-group">
                        <label for="comment-content">è¯„è®ºå†…å®¹:</label>
                        <textarea id="comment-content" rows="4" placeholder="è¯·è¾“å…¥è¯„è®ºå†…å®¹..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="comment-priority">ä¼˜å…ˆçº§:</label>
                        <select id="comment-priority">
                            <option value="low">ä½</option>
                            <option value="normal" selected>æ™®é€š</option>
                            <option value="high">é«˜</option>
                            <option value="urgent">ç´§æ€¥</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="save-comment" class="btn btn-primary">ä¿å­˜</button>
                    <button id="cancel-comment" class="btn btn-secondary">å–æ¶ˆ</button>
                </div>
            </div>
        </div>

        <!-- è¯„è®ºè¯¦æƒ…å¼¹çª— -->
        <div id="comment-detail-popup" class="comment-popup">
            <div class="popup-content">
                <div class="popup-header">
                    <div class="comment-info">
                        <span class="comment-number">#1</span>
                        <span class="comment-author">ä½œè€…å§“å</span>
                        <span class="comment-time">2024-01-15 14:30</span>
                    </div>
                    <div class="popup-actions">
                        <button class="action-btn edit-btn" title="ç¼–è¾‘">âœï¸</button>
                        <button class="action-btn delete-btn" title="åˆ é™¤">ğŸ—‘ï¸</button>
                        <button class="close-popup-btn">&times;</button>
                    </div>
                </div>
                <div class="popup-body">
                    <div class="comment-content-display">
                        è¯„è®ºå†…å®¹å°†åœ¨è¿™é‡Œæ˜¾ç¤º
                    </div>
                    <div class="comment-status">
                        <span class="priority-badge normal">æ™®é€š</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- å¼•å…¥è¯„è®ºç³»ç»Ÿ -->
    <script src="comment-system.js"></script>
    
    <!-- æ¼”ç¤ºé¡µé¢ä¸“ç”¨è„šæœ¬ -->
    <script>
        // ä¿å­˜åˆ°æ–‡ä»¶
        async function saveToFile() {
            if (window.commentSystem) {
                const success = await window.commentSystem.saveToJsonFile();
                if (success) {
                    alert('è¯„è®ºæ•°æ®å·²ä¿å­˜åˆ°æ–‡ä»¶ï¼');
                    updateSaveButtonState();
                }
            }
        }

        // ä»æ–‡ä»¶åŠ è½½
        function loadFromFile() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const data = JSON.parse(e.target.result);
                            window.commentSystem.importComments(data);
                            // æ¸…ç†ç¼“å­˜
                            localStorage.removeItem('comment-system-cache');
                            updateSaveButtonState();
                            alert('è¯„è®ºæ•°æ®åŠ è½½æˆåŠŸï¼');
                        } catch (error) {
                            alert('åŠ è½½å¤±è´¥ï¼šæ–‡ä»¶æ ¼å¼é”™è¯¯');
                        }
                    };
                    reader.readAsText(file);
                }
            };
            input.click();
        }

        // å¯¼å‡ºè¯„è®ºæ•°æ®
        function exportComments() {
            const data = window.commentSystem.exportComments();
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `comments-export-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert('è¯„è®ºæ•°æ®å·²å¯¼å‡ºï¼');
        }

        // æ›´æ–°ä¿å­˜æŒ‰é’®çŠ¶æ€
        function updateSaveButtonState() {
            const saveBtn = document.getElementById('save-btn');
            if (window.commentSystem && window.commentSystem.hasUnsavedData()) {
                saveBtn.textContent = 'ğŸ’¾ ä¿å­˜åˆ°æ–‡ä»¶ *';
                saveBtn.style.background = '#dc3545';
                saveBtn.title = 'æœ‰æœªä¿å­˜çš„è¯„è®ºæ•°æ®';
            } else {
                saveBtn.textContent = 'ğŸ’¾ ä¿å­˜åˆ°æ–‡ä»¶';
                saveBtn.style.background = '#007bff';
                saveBtn.title = 'ä¿å­˜è¯„è®ºæ•°æ®åˆ°JSONæ–‡ä»¶';
            }
        }

        // æ¸…ç©ºæ‰€æœ‰è¯„è®º
        function clearAllComments() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰è¯„è®ºå—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚')) {
                window.commentSystem.clearAllComments();
                // æ¸…ç†æ‰€æœ‰ç¼“å­˜æ•°æ®
                localStorage.removeItem('comment-system-cache');
                localStorage.removeItem('comment-system-data');
                updateSaveButtonState();
                alert('æ‰€æœ‰è¯„è®ºå·²æ¸…ç©ºï¼');
            }
        }
        
        // ä¿®å¤æ•°æ®åŠŸèƒ½
        function fixCommentData() {
            if (window.commentSystem) {
                // æ¸…ç†å½“å‰æ•°æ®
                window.commentSystem.comments = window.commentSystem.comments.map(comment => {
                    return window.commentSystem.cleanCommentData(comment);
                }).filter(comment => comment !== null);
                
                // é‡æ–°ä¿å­˜
                window.commentSystem.saveToStorage();
                
                // é‡æ–°åˆ›å»ºæ ‡è®°
                document.getElementById('comment-markers').innerHTML = '';
                window.commentSystem.comments.forEach(comment => {
                    window.commentSystem.createMarker(comment);
                });
                
    
                window.commentSystem.updateCommentsList();
                updateSaveButtonState();
                
                alert('æ•°æ®ä¿®å¤å®Œæˆï¼');
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // å¼€å¯è°ƒè¯•æ¨¡å¼
            window.commentDebug = true;
            
            // å»¶è¿Ÿåˆå§‹åŒ–ï¼Œç¡®ä¿è¯„è®ºç³»ç»Ÿå®Œå…¨åŠ è½½
            setTimeout(() => {
                // è‡ªåŠ¨ä¿®å¤æ•°æ®ï¼ˆé™é»˜ï¼‰
                if (window.commentSystem) {
                    const originalLength = window.commentSystem.comments.length;
                    window.commentSystem.comments = window.commentSystem.comments.map(comment => {
                        return window.commentSystem.cleanCommentData(comment);
                    }).filter(comment => comment !== null);
                    
                    if (window.commentSystem.comments.length !== originalLength) {
                        console.log(`å·²æ¸…ç† ${originalLength - window.commentSystem.comments.length} æ¡æ— æ•ˆè¯„è®ºæ•°æ®`);
                        window.commentSystem.saveToStorage();
            
                        window.commentSystem.updateCommentsList();
                    }
                }
                
                // æ›´æ–°ä¿å­˜æŒ‰é’®çŠ¶æ€
                updateSaveButtonState();
                
                // ä¸å†è‡ªåŠ¨æ·»åŠ ç¤ºä¾‹è¯„è®ºï¼Œåªä»JSONæ–‡ä»¶åŠ è½½
                console.log('è¯„è®ºç³»ç»Ÿåˆå§‹åŒ–å®Œæˆï¼Œå½“å‰è¯„è®ºæ•°ï¼š', window.commentSystem.comments.length);
            }, 1000);
            
            // å®šæœŸæ£€æŸ¥ä¿å­˜çŠ¶æ€
            setInterval(() => {
                updateSaveButtonState();
            }, 5000);
        });

        // æ·»åŠ ç¤ºä¾‹è¯„è®º
        function addSampleComments() {
            // å»¶è¿Ÿæ·»åŠ ï¼Œç¡®ä¿é¡µé¢å®Œå…¨åŠ è½½
            setTimeout(() => {
                // åŠ¨æ€åˆ›å»ºè¯„è®ºï¼ŒåŸºäºå®é™…é¡µé¢å…ƒç´ 
                const demoTitle = document.querySelector('.demo-title');
                const firstCard = document.querySelector('.demo-card:first-child h3');
                const mockupArea = document.querySelector('.demo-mockup');
                
                if (!demoTitle || !firstCard || !mockupArea) {
                    console.warn('æ— æ³•æ‰¾åˆ°ç›®æ ‡å…ƒç´ ï¼Œè·³è¿‡ç¤ºä¾‹è¯„è®ºåˆ›å»º');
                    return;
                }
                
                const sampleComments = [
                    {
                        id: 1,
                        targetElement: window.commentSystem.generateElementSelector(demoTitle),
                        offsetX: 50,
                        offsetY: 10,
                        author: 'äº§å“ç»ç†',
                        content: 'æ ‡é¢˜è®¾è®¡å¾ˆæ£’ï¼å»ºè®®å­—ä½“å¯ä»¥å†å¤§ä¸€äº›ï¼Œæ›´çªå‡ºä¸»é¢˜ã€‚',
                        priority: 'high',
                        status: 'unresolved',
                        timestamp: new Date(Date.now() - 2 * 60 * 60 * 1000).toISOString(), // 2å°æ—¶å‰
                        replies: [
                            {
                                id: 1001,
                                author: 'UIè®¾è®¡å¸ˆ',
                                content: 'å¥½çš„ï¼Œæˆ‘ä¼šåœ¨ä¸‹ä¸ªç‰ˆæœ¬ä¸­è°ƒæ•´å­—ä½“å¤§å°ã€‚',
                                timestamp: new Date(Date.now() - 1 * 60 * 60 * 1000).toISOString() // 1å°æ—¶å‰
                            }
                        ]
                    },
                    {
                        id: 2,
                        targetElement: window.commentSystem.generateElementSelector(firstCard),
                        offsetX: 20,
                        offsetY: 5,
                        author: 'æµ‹è¯•å·¥ç¨‹å¸ˆ',
                        content: 'åŠŸèƒ½åˆ—è¡¨å¾ˆæ¸…æ™°ï¼Œå»ºè®®æ·»åŠ æ›´å¤šçš„ä½¿ç”¨åœºæ™¯è¯´æ˜ã€‚',
                        priority: 'urgent',
                        status: 'unresolved',
                        timestamp: new Date(Date.now() - 30 * 60 * 1000).toISOString(), // 30åˆ†é’Ÿå‰
                        replies: []
                    },
                    {
                        id: 3,
                        targetElement: window.commentSystem.generateElementSelector(mockupArea),
                        offsetX: 100,
                        offsetY: 50,
                        author: 'å‰ç«¯å¼€å‘',
                        content: 'æµ‹è¯•åŒºåŸŸçš„æç¤ºå¾ˆå‹å¥½ï¼Œç”¨æˆ·ä½“éªŒä¸é”™ï¼',
                        priority: 'normal',
                        status: 'resolved',
                        timestamp: new Date(Date.now() - 4 * 60 * 60 * 1000).toISOString(), // 4å°æ—¶å‰
                        replies: [
                            {
                                id: 1002,
                                author: 'äº§å“ç»ç†',
                                content: 'æ„Ÿè°¢åé¦ˆï¼è¿™æ ·çš„è®¾è®¡ç¡®å®æ›´ç›´è§‚ã€‚',
                                timestamp: new Date(Date.now() - 3 * 60 * 60 * 1000).toISOString() // 3å°æ—¶å‰
                            }
                        ]
                    }
                ];
                
                // æ·»åŠ ç¤ºä¾‹è¯„è®ºåˆ°ç³»ç»Ÿä¸­
                window.commentSystem.comments = sampleComments;
                window.commentSystem.commentCounter = 3;

                // åˆ›å»ºæ ‡è®°
                sampleComments.forEach(comment => {
                    window.commentSystem.createMarker(comment);
                });

                // æ›´æ–°ç»Ÿè®¡å’Œåˆ—è¡¨
    
                window.commentSystem.updateCommentsList();
                window.commentSystem.saveToStorage();

                console.log('å·²æ·»åŠ ç¤ºä¾‹è¯„è®ºæ•°æ®');
                updateSaveButtonState();
                alert('ç¤ºä¾‹è¯„è®ºå·²æ·»åŠ ï¼è¯·ç‚¹å‡»"ä¿å­˜åˆ°æ–‡ä»¶"æŒ‰é’®ä¿å­˜æ•°æ®ã€‚');
            }, 500);
        }

        // æ·»åŠ é¡µé¢æç¤º
        setTimeout(() => {
            if (window.commentSystem && window.commentSystem.comments.length > 0) {
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed;
                    top: 100px;
                    right: 20px;
                    background: #28a745;
                    color: white;
                    padding: 15px 20px;
                    border-radius: 8px;
                    box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
                    z-index: 1002;
                    font-size: 14px;
                    max-width: 300px;
                    animation: slideIn 0.3s ease;
                `;
                notification.innerHTML = `
                    <strong>ğŸ’¡ æç¤º</strong><br>
                    é¡µé¢ä¸Šå·²æœ‰ç¤ºä¾‹è¯„è®ºï¼Œæ‚¨å¯ä»¥ç‚¹å‡»æŸ¥çœ‹æˆ–æ·»åŠ æ–°çš„è¯„è®ºï¼
                `;
                
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.style.animation = 'slideOut 0.3s ease forwards';
                    setTimeout(() => {
                        document.body.removeChild(notification);
                    }, 300);
                }, 5000);
            }
        }, 2000);

        // æ·»åŠ åŠ¨ç”»æ ·å¼
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
        
        // é¡µé¢å¸è½½æ—¶æ¸…ç†èµ„æºå’Œæé†’ä¿å­˜
        window.addEventListener('beforeunload', function(e) {
            if (window.commentSystem) {
                // æ£€æŸ¥æ˜¯å¦æœ‰æœªä¿å­˜çš„æ•°æ®
                if (window.commentSystem.hasUnsavedData()) {
                    const message = 'æ‚¨æœ‰æœªä¿å­˜çš„è¯„è®ºæ•°æ®ï¼Œç¡®å®šè¦ç¦»å¼€å—ï¼Ÿ';
                    e.preventDefault();
                    e.returnValue = message;
                    return message;
                }
                
                window.commentSystem.cleanup();
            }
        });
    </script>
</body>
</html>